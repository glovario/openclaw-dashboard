{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://openclaw.local/schemas/reports-tokens-response.json",
  "title": "GET /api/reports/tokens response",
  "type": "object",
  "required": ["ok", "window", "filters", "totals", "by_agent", "by_task", "by_model", "trend"],
  "properties": {
    "ok": { "const": true },
    "window": { "enum": ["7", "30", "90", "custom"] },
    "filters": {
      "type": "object",
      "required": ["start", "end", "include_unlinked"],
      "properties": {
        "start": { "type": "string", "format": "date-time" },
        "end": { "type": "string", "format": "date-time" },
        "include_unlinked": { "type": "boolean" }
      },
      "additionalProperties": false
    },
    "totals": {
      "type": "object",
      "required": ["prompt_tokens", "completion_tokens", "total_tokens", "cost_usd", "event_count", "linked_events", "unlinked_events"],
      "properties": {
        "prompt_tokens": { "type": "integer", "minimum": 0 },
        "completion_tokens": { "type": "integer", "minimum": 0 },
        "total_tokens": { "type": "integer", "minimum": 0 },
        "cost_usd": { "type": "number", "minimum": 0 },
        "event_count": { "type": "integer", "minimum": 0 },
        "linked_events": { "type": "integer", "minimum": 0 },
        "unlinked_events": { "type": "integer", "minimum": 0 }
      },
      "additionalProperties": false
    },
    "by_agent": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["agent", "total_tokens", "cost_usd", "event_count"],
        "properties": {
          "agent": { "type": "string" },
          "total_tokens": { "type": "integer", "minimum": 0 },
          "cost_usd": { "type": "number", "minimum": 0 },
          "event_count": { "type": "integer", "minimum": 0 }
        },
        "additionalProperties": false
      }
    },
    "by_task": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["task_id", "task_display_id", "task_title", "total_tokens", "cost_usd", "event_count"],
        "properties": {
          "task_id": { "type": ["integer", "null"] },
          "task_display_id": { "type": "string" },
          "task_title": { "type": "string" },
          "total_tokens": { "type": "integer", "minimum": 0 },
          "cost_usd": { "type": "number", "minimum": 0 },
          "event_count": { "type": "integer", "minimum": 0 }
        },
        "additionalProperties": false
      }
    },
    "by_model": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["model", "total_tokens", "cost_usd", "event_count"],
        "properties": {
          "model": { "type": "string" },
          "total_tokens": { "type": "integer", "minimum": 0 },
          "cost_usd": { "type": "number", "minimum": 0 },
          "event_count": { "type": "integer", "minimum": 0 }
        },
        "additionalProperties": false
      }
    },
    "trend": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["day", "total_tokens", "cost_usd", "event_count"],
        "properties": {
          "day": { "type": "string", "pattern": "^\\d{4}-\\d{2}-\\d{2}$" },
          "total_tokens": { "type": "integer", "minimum": 0 },
          "cost_usd": { "type": "number", "minimum": 0 },
          "event_count": { "type": "integer", "minimum": 0 }
        },
        "additionalProperties": false
      }
    }
  },
  "additionalProperties": false
}
